<?xml version="1.0" encoding="utf-8"?>

<config>
    <server>
        <name>Fail IRC</name>

        <!--
        This is the showed MOTD, you can put type="code", the content will be evaluated and the resulting
        puts will be showed as MOTD.
        -->
        <motd><![CDATA[
            Welcome to a fail IRC.
        ]]></motd>

        <pingTimeout>60</pingTimeout>
        
        <listen port="6667"/>
        <listen port="6697" ssl="enabled"/> <!-- sslKey="/etc/failirc/rsa.key" sslCert="/etc/failirc/cert.pem" -->
    </server>

    <operators>
        <operator mask="meh!*@*" password="password" flags="netadmin"/>
    </operators>

    <modules>
        <module name="Base">
            <misc>
                <!-- When this evaluated code is false, an erroneus nickname message is sent -->
                <nickAllowed>nick.match(/^[\w^`-]{1,23}$/)</nickAllowed>
            </misc>

            <messages>
                <version>#{server.modules.each do |module| if module.method(:to_s) then module.to_s end end}</version>

                <quit>Quit: #{message}</quit>
                <kill>Kill: #{(message &amp;&amp; !message.empty?) ? message : 'No reason'} (#{sender.nick})</kill>
            </messages>
        </module>

        <module name="Firewall">
            <!-- <file>/var/log/failirc.log</file> -->

            <chain name="INPUT" policy="ACCEPT">
                <rule type="LOG">.</rule>

                <!-- http://www.encyclopediadramatica.com/DCC_SEND_startkeylogger_0_0_0 -->
                <rule type="DROP">PRIVMSG.*?:(\x01)?DCC SEND ..............</rule>
            </chain>

            <chain name="OUTPUT" policy="ACCEPT">
                <rule type="LOG">.</rule>
            </chain>
        </module>

        <module name="TinyURL">
            <length>42</length>
            <timeout>5</timeout>
        </module>

        <module name="Netlog"/>

        <module name="Roulette">
            <!-- Be aware that these strings get evalled, you're warned. -->
            <death>BOOM, dickshot.</death>
            <life>#{user.nick} shot but survived :(</life>
        </module>

        <module name="WordFilter">
            <replaces>
                <replace word="giallo" with="\x035giallo\x03"/>
            </replaces>

            <rainbow>rrRRyyYYGGggccCCBBppPP</rainbow>
        </module>

        <module name="Cloaking"/>
    </modules>
</config>
